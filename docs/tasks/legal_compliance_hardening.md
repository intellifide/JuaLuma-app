# Task: Legal Compliance Hardening Implementation Plan

## 1. Create ExternalLinkModal Component
*   **File:** `frontend/src/components/ExternalLinkModal.tsx`
*   **Description:** A modal component that displays a security disclaimer before the user is redirected to a third-party service (Plaid/CEX).
*   **Structure:**
    *   Use standardized CSS classes: `modal`, `modal-content`, `modal-header`, `modal-body`.
    *   **Props:** `isOpen`, `onClose`, `onConfirm`, `providerName`.
    *   **Content:**
        *   Header: "External Connection Warning"
        *   Body: "You are securely connecting to your financial institution via **[ProviderName]**. JuaLuma does not see, store, or have access to your external login credentials. You are interacting directly with [ProviderName]."
        *   actions: "Cancel" (ghost button), "Continue to Secure Login" (primary button).

## 2. Refactor PlaidLinkButton
*   **File:** `frontend/src/components/PlaidLinkButton.tsx`
*   **Changes:**
    *   Import `ExternalLinkModal`.
    *   Add state: `const [showModal, setShowModal] = useState(false);`.
    *   Refactor `handleOpen` to `setShowModal(true)`.
    *   Create `handleConfirm` that calls the original `open()` (Plaid Link) and then `setShowModal(false)`.
    *   Render the `ExternalLinkModal` portal or inline (if simplistic).
    *   Ensure the button `disabled` state respects the loading state.

## 3. Update AI Assistant Interface
*   **File:** `frontend/src/pages/AIAssistant.tsx`
*   **Changes:**
    *   **Remove:** The `.alert-info` div at the top of the chat interface.
    *   **Add:** A fixed footer component inside the chat container (or main layout specific to this page).
    *   **Footer Content:**
        *   Container with `glass-panel` style or distinctive background.
        *   Text: "Disclaimer: JuaLuma Insights are generated by AI for informational purposes only. Do not rely on them for financial decisions."
    *   **Styling:** Ensure it stays at the bottom and doesn't overlap the input area, or is part of the `ChatInput` area wrapper.

## 4. Updates to Legal Documents (Frontend)
*   **File:** `frontend/src/pages/legal/Terms.tsx`
    *   **Replace:** Section 5 (AI Disclaimer) with text from `intellifide-planning/.../Terms-of-Service.md` (Section 5).
    *   **Replace:** Section 13 (Dispute Resolution) with text from `intellifide-planning/.../Terms-of-Service.md` (Section 13).
*   **File:** `frontend/src/pages/legal/Privacy.tsx`
    *   **Insert:** Section 4.1 "The Bridge" (Third-Party Integrations) from `intellifide-planning/.../Privacy-Policy.md`.
    *   **Insert:** Section 4.2 "Biometric Data" from `intellifide-planning/.../Privacy-Policy.md`.

## 5. Verification
*   **Manual:** Verify that clicking "Connect with Plaid" shows the modal. Confirming opens Plaid. Canceling closes modal.
*   **Manual:** Verify AI page has no top banner and has a footer.
*   **Manual:** Verify Terms and Privacy pages reflect the rigid legal text.
